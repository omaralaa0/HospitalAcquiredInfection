<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Patients - Cura Solve</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: #f4f6f9;
        }

        .btn:hover {
            transform: translateY(-2px);
            transition: 0.2s;
        }

        table th,
        table td {
            vertical-align: middle;
            text-align: center;
        }
    </style>
        <style>
        .navbar-lightgray {
            background-color: #A8A8A8;
            /* light gray */
        }

        .navbar-lightgray .nav-link {
            color: #000;
            /* dark text for contrast */
        }

        .navbar-lightgray .nav-link.active {
            color: #007bff;
            /* highlight active link */
        }
    </style>
    <script>
        function deletePatient(id) {
            if (!confirm("Are you sure you want to delete patient " + id + "?")) return;
            fetch(`/patients/${id}`, { method: "DELETE" })
                .then(res => res.json())
                .then(data => { alert(data.message || "Deleted"); location.reload(); })
                .catch(err => alert("Error: " + err));
        }
    </script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-lightgray shadow-sm mb-4">
        <div class="container">
            <a class="navbar-brand" href="/">
                <img src="{{ url_for('static', filename='logo.png') }}" alt="Cura Solve" height="80">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link {% if request.path=='/' %}active{% endif %}"
                            href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link {% if '/patients' in request.path %}active{% endif %}"
                            href="/patients">Patients</a></li>
                    <li class="nav-item"><a class="nav-link {% if '/stats' in request.path %}active{% endif %}"
                            href="/stats">Stats</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="text-primary">Patients</h2>


            <a href="/" class="btn btn-primary">Add Patient</a>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Phone</th>
                        <th>Age</th>
                        <th>Gender</th>
                        <th>Prediction</th>
                        <th>Probability</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in patients %}
                    <tr>
                        <td>{{ p.id }}</td>
                        <td>{{ p.name }}</td>
                        <td>{{ p.phone }}</td>
                        <td>{{ p.age }}</td>
                        <td>{{ p.gender }}</td>
                        <td>{{ p.prediction }}</td>
                        <td>{{ "%.2f" % (p.probability*100) if p.probability is not none else "N/A" }}%</td>
                        <td>
                            <a href="/patients/{{p.id}}/edit" class="btn btn-success btn-sm me-1">Edit</a>
                            <button class="btn btn-danger btn-sm" onclick="deletePatient({{p.id}})">Delete</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>