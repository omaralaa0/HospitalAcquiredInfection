<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sepsis Predictor - Cura Solve</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; background: #f4f6f9; }
        .card { border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { font-weight: 700; color: #007bff; }
        button:hover { transform: translateY(-2px); transition: 0.2s; }
        .hint { font-size: 12px; color: gray; margin-top: 3px; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
        <div class="container">
            <a class="navbar-brand" href="/"><img src="{{ url_for('static', filename='logo.png') }}" alt="Cura Solve" height="60"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link {% if request.path=='/' %}active{% endif %}" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link {% if '/patients' in request.path %}active{% endif %}" href="/patients">Patients</a></li>
                    <li class="nav-item"><a class="nav-link {% if '/stats' in request.path %}active{% endif %}" href="/stats">Stats</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="card p-4">
            <h2 class="text-center mb-4">{{ "Update Patient" if patient else "Sepsis Prediction Form" }}</h2>
            <form method="POST" action="{{ url_for('predict') if not patient else url_for('update_patient', patient_id=patient.id) }}">
                
                <h5>Patient Information</h5>
                <div class="row g-3 mb-3">
                    <div class="col-md-4">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" name="name" value="{{ patient.name if patient else '' }}" required>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Phone Number</label>
                        <input type="text" class="form-control" name="phone" value="{{ patient.phone if patient else '' }}">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Address</label>
                        <input type="text" class="form-control" name="address" value="{{ patient.address if patient else '' }}">
                    </div>
                </div>

                <h5>Clinical Data</h5>
                <div class="row g-3 mb-3">
                    {% set fields = [
                        ('HR','Heart rate','Beats per minute'), ('O2Sat','Pulse oximetry','Percentage (%)'), 
                        ('Temp','Temperature','Degrees Celsius'), ('MAP','Mean arterial pressure','mm Hg'), 
                        ('Resp','Respiration rate','Breaths per minute'), ('BUN','BUN','mg/dL'),
                        ('Chloride','Chloride','mmol/L'), ('Creatinine','Creatinine','mg/dL'), ('Glucose','Serum glucose','mg/dL'),
                        ('Hct','Hematocrit','Percentage (%)'), ('Hgb','Hemoglobin','g/dL'), ('WBC','Leukocyte count','Count / L'),
                        ('Platelets','Platelet count','Count / mL'), ('Age','Age','Years'), 
                        ('HospAdmTime','Hospital to ICU admission','Hours since ICU admission'),
                        ('ICULOS','ICU length of stay','Hours since ICU admission')
                    ] %}
                    {% for key,label,hint in fields %}
                    <div class="col-md-4">
                        <label class="form-label">{{ label }}</label>
                        <input type="number" step="0.1" class="form-control" name="{{ key }}" value="{{ getattr(patient,key.lower()) if patient else '' }}" required>
                        <p class="hint">{{ hint }}</p>
                    </div>
                    {% endfor %}
                    <div class="col-md-4">
                        <label class="form-label">Gender</label>
                        <select class="form-select" name="Gender" required>
                            <option value="">--Select--</option>
                            <option value="0" {% if patient and patient.gender=="Female" %}selected{% endif %}>Female</option>
                            <option value="1" {% if patient and patient.gender=="Male" %}selected{% endif %}>Male</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary w-100 py-2">{{ "Update" if patient else "Predict" }}</button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
